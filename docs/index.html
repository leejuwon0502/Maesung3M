<html>
	<head>
		<title>3M</title>
		<meta charset="utf-8" />
		<script src="./test.js"></script>
		<style>
			* { padding: 0; margin: 0; }
			canvas { background: #eee; display: block; margin: 0 auto; }
		</style>
	</head>
	<body>
		<canvas id="Canvas" width="480" height="320"></canvas>
		<script>
			var canvas = document.getElementById("Canvas");
			var ctx = canvas.getContext("2d");
			window.addEventListener("keydown", KeyDown);
			window.addEventListener("keyup", KeyUp);
			canvas.width = document.body.clientWidth;
			canvas.height = document.body.clientHeight;
			//system
			var OnPress = {};
			var PressedKeys = {};
			function KeyDown(e) {
			    var code = e.keyCode;
			    switch (code) {
			    	case 87: PressedKeys['w'] = OnPress.w; break;
			    	case 65: PressedKeys['a'] = OnPress.a; break;
			    	case 83: PressedKeys['s'] = OnPress.s; break;
			    	case 68: PressedKeys['d'] = OnPress.d; break;
			    }
			}
			function KeyUp(e) {
			    var code = e.keyCode;
			    switch (code) {
			    	case 87: delete PressedKeys.w; break;
			    	case 65: delete PressedKeys.a; break;
			    	case 83: delete PressedKeys.s; break;
			    	case 68: delete PressedKeys.d; break;
			    }
			}
			function OnKey(key, func) {
				OnPress[key] = func;
			}
			function Render() {
				MoveChar();
			}
			function Update() {
				Render();
				Controll();
				requestAnimationFrame(Update);
			}
			function Controll() {
				for(let key in PressedKeys) {
					PressedKeys[key]();
				}
			}
			class GameObject {
				constructor(coord = { x : canvas.width/2, y : canvas.height/2}) {
					this.x = coord.x;
					this.y = coord.y;
				}
			}
			//api
			function IsCollideWithWall() { //fix
				if(x + dx > canvas.width-CharRadius || x + dx < CharRadius) {
				    dx = -dx;
				}
				if(y + dy > canvas.height-CharRadius || y + dy < CharRadius) {
				    dy = -dy;
				}
			}
			//variables
			let Char = new GameObject()
			Char.Radius = 10;
			var MoveSpeed = 10;
			//code
			function MoveChar() {
				ctx.beginPath();
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				ctx.arc(Char.x, Char.y, Char.Radius, 0, Math.PI*2);
				ctx.fillStyle = "#0095DD";
				ctx.fill();
				ctx.closePath();
			}
			OnKey('w', () => {
				Char.y -= MoveSpeed;
			})
			OnKey('a', () => {
				Char.x -= MoveSpeed;
			})
			OnKey('s', () => {
				Char.y += MoveSpeed;
			})
			OnKey('d', () => {
				Char.x += MoveSpeed;
			})
			//repeat
			Update();
		</script>
	</body>
</html>

